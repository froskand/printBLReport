Sub ButtonPrint_Click()
    Dim strPDFFileName As String
    Dim strDocID As String
    Dim strDocRev As String
    Dim fso As Object
    Dim wsBaseline As Worksheet
    Dim wsReview As Worksheet
    
    On Error GoTo Failure
    
    ' Get document information
    With ThisWorkbook.Worksheets("Introduction")
        strDocID = .Range("C5").Value
        strDocRev = .Range("C6").Value
    End With
    
    ' Build PDF filename
    strPDFFileName = Application.ActiveWorkbook.Path & "\" & strDocID & " rev " & strDocRev & " BaselineReport.pdf"
    
    ' Check if file already exists
    Set fso = CreateObject("Scripting.FileSystemObject")
    If fso.FileExists(strPDFFileName) Then
        MsgBox "A file with this name already exists:" & Chr(13) & Chr(13) & _
               strPDFFileName & Chr(13) & Chr(13) & _
               "Please update the revision number in cell C6 of the Introduction sheet.", _
               vbExclamation, "File Already Exists"
        GoTo Done
    End If
    
    ' Confirm save
    If MsgBox("Do you want to save the baseline document as a PDF?" & Chr(13) & Chr(13) & _
              "Saving as: " & strPDFFileName & Chr(13) & _
              "Path length: " & Len(strPDFFileName) & " characters", vbOKCancel + vbQuestion, "Save PDF") = vbCancel Then
        GoTo Done
    End If
    
    ' Set up repeating rows for Baseline content sheet
    Set wsBaseline = ThisWorkbook.Worksheets("Baseline content")
    With wsBaseline.PageSetup
        .PrintTitleRows = "$2:$4"  ' Repeat rows 2-4 as headers
    End With
    
    ' Set up repeating rows for Review sheet
    Set wsReview = ThisWorkbook.Worksheets("Review")
    With wsReview.PageSetup
        .PrintTitleRows = "$24:$25"  ' Repeat rows 24-25 as headers
    End With
    
    ' Export selected sheets to PDF
    ThisWorkbook.Sheets(Array("Introduction", "Review", "Baseline content", "Change tracking")).Select
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=strPDFFileName
    
    ' Verify file was created
    If Not fso.FileExists(strPDFFileName) Then
        MsgBox "Error: PDF file was not saved successfully!" & Chr(13) & Chr(13) & _
               "Expected location: " & strPDFFileName, vbCritical, "Save Failed"
    Else
        MsgBox "PDF saved successfully!" & Chr(13) & Chr(13) & strPDFFileName, vbInformation, "Success"
    End If
    
Done:
    ThisWorkbook.Sheets("Introduction").Select
    Exit Sub
    
Failure:
    MsgBox "Failed to save PDF: " & Err.Description, vbCritical, "Error"
    ThisWorkbook.Sheets("Introduction").Select
End Sub